<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/head :: common-head('Level ' + ${riddle.id})}"></head>
<body>
    <header th:replace="~{common/header :: common-header}"></header>

    <div class="container">
        <h2 th:text="'LEVEL ' + ${riddle.id} + ': SECURITY CHECK'">LEVEL X</h2>
        <p>セキュリティ・質問に回答せよ</p>
        
        <h3 class="question-text"
            th:utext="${#strings.replace(riddle.question, '&#10;', '<br>')}">
        </h3>
        
        <p class="hint-text" th:text="'HINT: ' + ${riddle.hint}"></p>

        <!-- 画像表示（画像マップ型以外） -->
        <div th:if="${riddle.type != 'image-map' and riddle.imageUrl != null}" class="image-container">
            <img th:src="@{${riddle.imageUrl}}" class="puzzle-image">
        </div>

        <!-- 画像マップ型の問題表示 -->
        <div th:replace="fragments/hacker/quiz_types_image_map :: image_map_section"></div>

        <!-- ストーリー型の問題表示 -->
        <div th:replace="fragments/hacker/quiz_types_story :: story_section"></div>

        <!-- 次ページにデータを送信する問題表示 -->
        <form th:id="${riddle.type == 'sort'} ? 'sortForm' : 'quizForm'" th:action="@{/hacker/quiz/check}" method="post" 
          th:unless="${riddle.type == 'image-map' || riddle.type == 'story'}">
            <input type="hidden" name="id" th:value="${riddle.id}" />

            <!-- セレクト型の問題表示 -->
            <div th:replace="fragments/hacker/quiz_types_select :: select_section"></div>

            <!-- クリック型の問題表示 -->
            <div th:replace="fragments/hacker/quiz_types_click :: click_section"></div>

            <!-- 並べ替え型の問題表示 -->
            <div th:replace="fragments/hacker/quiz_types_sort :: sort_section"></div>

            <!-- テキスト入力型の問題表示 -->
            <div th:replace="fragments/hacker/quiz_input_area :: input_area_section"></div>
        </form>
        
        <!-- 中断リンク（ストーリー型以外で表示） -->
        <div th:if="${riddle.type != 'story'}" class="back-to-list">
            <a th:href="@{/hacker/list}">&lt;&lt; Abort (List)</a>
        </div>
    </div>
</body>
</html>